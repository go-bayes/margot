<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Flip (Reverse) Causal Forest Treatment Effects — margot_flip_forests • margot</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Flip (Reverse) Causal Forest Treatment Effects — margot_flip_forests"><meta name="description" content="This function is now a convenience wrapper around margot_causal_forest() with the
flip_outcomes parameter. It allows flipping existing models by recomputing them
with inverted outcomes."><meta property="og:description" content="This function is now a convenience wrapper around margot_causal_forest() with the
flip_outcomes parameter. It allows flipping existing models by recomputing them
with inverted outcomes."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">margot</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.273</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/go-bayes/margot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Flip (Reverse) Causal Forest Treatment Effects</h1>
      <small class="dont-index">Source: <a href="https://github.com/go-bayes/margot/blob/HEAD/R/margot_flip_forests.R" class="external-link"><code>R/margot_flip_forests.R</code></a></small>
      <div class="d-none name"><code>margot_flip_forests.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is now a convenience wrapper around margot_causal_forest() with the
flip_outcomes parameter. It allows flipping existing models by recomputing them
with inverted outcomes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">margot_flip_forests</span><span class="op">(</span></span>
<span>  <span class="va">model_results</span>,</span>
<span>  <span class="va">flip_outcomes</span>,</span>
<span>  model_prefix <span class="op">=</span> <span class="st">"model_"</span>,</span>
<span>  flip_method <span class="op">=</span> <span class="st">"zscore"</span>,</span>
<span>  flip_scale_bounds <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grf_defaults <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html" class="external-link">availableCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  remove_original <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  qini_treatment_cost <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  train_proportion <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_train_test_split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">12345</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model-results">model_results<a class="anchor" aria-label="anchor" href="#arg-model-results"></a></dt>
<dd><p>A list containing the model results from margot_causal_forest().</p></dd>


<dt id="arg-flip-outcomes">flip_outcomes<a class="anchor" aria-label="anchor" href="#arg-flip-outcomes"></a></dt>
<dd><p>A character vector of outcome variable names for which models should be flipped.</p></dd>


<dt id="arg-model-prefix">model_prefix<a class="anchor" aria-label="anchor" href="#arg-model-prefix"></a></dt>
<dd><p>A character string indicating the prefix used for model names in the results list. Default is "model_".</p></dd>


<dt id="arg-flip-method">flip_method<a class="anchor" aria-label="anchor" href="#arg-flip-method"></a></dt>
<dd><p>Character string specifying default inversion method:
- "zscore": Simple negation (default). Assumes data is already standardized.
- "ordinal": Invert on ordinal scale using bounds.</p></dd>


<dt id="arg-flip-scale-bounds">flip_scale_bounds<a class="anchor" aria-label="anchor" href="#arg-flip-scale-bounds"></a></dt>
<dd><p>Numeric vector of length 2 [min, max] or named list of bounds per outcome.
Required when flip_method = "ordinal" unless bounds should be inferred from data.</p></dd>


<dt id="arg-grf-defaults">grf_defaults<a class="anchor" aria-label="anchor" href="#arg-grf-defaults"></a></dt>
<dd><p>A list of parameters to pass to the GRF causal forest models. Default is NULL,
which attempts to extract parameters from the original fitted models. Providing explicit values
ensures consistency between original and flipped models. Common parameters include num.trees,
honesty, honesty.fraction, alpha, min.node.size, and mtry.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical indicating whether to use parallel processing. Default is FALSE.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Number of cores to use for parallel processing. Default is availableCores() - 1.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical indicating whether to display detailed messages during execution. Default is TRUE.</p></dd>


<dt id="arg-remove-original">remove_original<a class="anchor" aria-label="anchor" href="#arg-remove-original"></a></dt>
<dd><p>Logical indicating whether to remove the original (non-flipped) models after
creating their flipped versions. Default is TRUE. When TRUE, only the flipped models with "_r"
suffix remain; when FALSE, both original and flipped models are kept.</p></dd>


<dt id="arg-qini-treatment-cost">qini_treatment_cost<a class="anchor" aria-label="anchor" href="#arg-qini-treatment-cost"></a></dt>
<dd><p>Scalar treatment cost per unit for QINI calculations. Default 1.
Lower values (e.g., 0.2) represent cheap treatments creating steeper QINI curves;
higher values (e.g., 5) represent expensive treatments creating shallower curves.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Random seed for reproducible QINI curve generation. Default 12345 matches the
default seed used in compute_qini_improved for consistency.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A modified copy of model_results with flipped models (with "_r" suffix). If remove_original
        is TRUE (default), original models are removed; otherwise both versions are kept.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function creates entirely new models by:
1. Extracting the original data for each outcome
2. Flipping the outcome variable (Y_flipped = -Y)
3. Calling margot_causal_forest() with the flipped outcome
4. Storing the result with "_r" suffix
5. Optionally removing the original models (default behavior)</p>
<p>This ensures all components (forest model, CATE estimates, QINI curves, policy trees,
E-values, etc.) are consistently computed based on the flipped outcome.</p>
<p>When grf_defaults is NULL, the function attempts to extract key GRF parameters from
the first fitted model to ensure consistency between original and flipped models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Flip models and remove originals (default)</span></span></span>
<span class="r-in"><span><span class="va">results_flipped</span> <span class="op">&lt;-</span> <span class="fu">margot_flip_forests</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">results</span>,</span></span>
<span class="r-in"><span>  flip_outcomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"anxiety"</span>, <span class="st">"depression"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Results now contain anxiety_r and depression_r, originals removed</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Keep both original and flipped models</span></span></span>
<span class="r-in"><span><span class="va">results_both</span> <span class="op">&lt;-</span> <span class="fu">margot_flip_forests</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">results</span>,</span></span>
<span class="r-in"><span>  flip_outcomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"anxiety"</span>, <span class="st">"depression"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  remove_original <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Results contain both anxiety/depression and anxiety_r/depression_r</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use custom GRF parameters for flipped models</span></span></span>
<span class="r-in"><span><span class="va">results_custom</span> <span class="op">&lt;-</span> <span class="fu">margot_flip_forests</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">results</span>,</span></span>
<span class="r-in"><span>  flip_outcomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"anxiety"</span>, <span class="st">"depression"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  grf_defaults <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>num.trees <span class="op">=</span> <span class="fl">4000</span>, honesty <span class="op">=</span> <span class="cn">TRUE</span>, honesty.fraction <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/go-bayes" class="external-link">Joseph A Bulbulia</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

