<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run Multiple Generalized Random Forest (GRF) Causal Forest Models with Enhanced Features — margot_causal_forest • margot</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Code-0.4.9/font.css" rel="stylesheet"><link href="../deps/Fira_Sans-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run Multiple Generalized Random Forest (GRF) Causal Forest Models with Enhanced Features — margot_causal_forest"><meta name="description" content="This function is a wrapper for grf::causal_forest that runs multiple GRF causal forest models
for specified outcome variables. It calculates average treatment effects, tests calibration,
creates custom evaluation tables, and includes additional features such as tau.hat estimates,
RATE calculations, policy trees, variable importance rankings, best linear projections,
and Qini curves.
It also prepares data for policy tree visualization, using a specified proportion of the data for training."><meta property="og:description" content="This function is a wrapper for grf::causal_forest that runs multiple GRF causal forest models
for specified outcome variables. It calculates average treatment effects, tests calibration,
creates custom evaluation tables, and includes additional features such as tau.hat estimates,
RATE calculations, policy trees, variable importance rankings, best linear projections,
and Qini curves.
It also prepares data for policy tree visualization, using a specified proportion of the data for training."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">margot</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1.47</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/go-bayes/margot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run Multiple Generalized Random Forest (GRF) Causal Forest Models with Enhanced Features</h1>
      <small class="dont-index">Source: <a href="https://github.com/go-bayes/margot/blob/HEAD/R/margot_causal_forest.R" class="external-link"><code>R/margot_causal_forest.R</code></a></small>
      <div class="d-none name"><code>margot_causal_forest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is a wrapper for grf::causal_forest that runs multiple GRF causal forest models
for specified outcome variables. It calculates average treatment effects, tests calibration,
creates custom evaluation tables, and includes additional features such as tau.hat estimates,
RATE calculations, policy trees, variable importance rankings, best linear projections,
and Qini curves.
It also prepares data for policy tree visualization, using a specified proportion of the data for training.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">margot_causal_forest</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">outcome_vars</span>,</span>
<span>  <span class="va">covariates</span>,</span>
<span>  <span class="va">W</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  grf_defaults <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  save_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  compute_rate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  top_n_vars <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  save_models <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  train_proportion <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  propensity_threshold <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing all necessary variables.</p></dd>


<dt id="arg-outcome-vars">outcome_vars<a class="anchor" aria-label="anchor" href="#arg-outcome-vars"></a></dt>
<dd><p>A character vector of outcome variable names to be modeled.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>A matrix of covariates to be used in the GRF models.</p></dd>


<dt id="arg-w">W<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>A vector of binary treatment assignments.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>A vector of weights for the observations.</p></dd>


<dt id="arg-grf-defaults">grf_defaults<a class="anchor" aria-label="anchor" href="#arg-grf-defaults"></a></dt>
<dd><p>A list of default parameters for the GRF models.</p></dd>


<dt id="arg-save-data">save_data<a class="anchor" aria-label="anchor" href="#arg-save-data"></a></dt>
<dd><p>Logical indicating whether to save data, covariates, and weights. Default is FALSE.</p></dd>


<dt id="arg-compute-rate">compute_rate<a class="anchor" aria-label="anchor" href="#arg-compute-rate"></a></dt>
<dd><p>Logical indicating whether to compute RATE for each model. Default is TRUE.</p></dd>


<dt id="arg-top-n-vars">top_n_vars<a class="anchor" aria-label="anchor" href="#arg-top-n-vars"></a></dt>
<dd><p>Integer specifying the number of top variables to use for additional computations. Default is 10.</p></dd>


<dt id="arg-save-models">save_models<a class="anchor" aria-label="anchor" href="#arg-save-models"></a></dt>
<dd><p>Logical indicating whether to save the full GRF model objects. Default is FALSE.</p></dd>


<dt id="arg-train-proportion">train_proportion<a class="anchor" aria-label="anchor" href="#arg-train-proportion"></a></dt>
<dd><p>Numeric value between 0 and 1 indicating the proportion of non-missing data to use for training policy trees. Default is 0.8.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p>
<dl><dt>results</dt>
<dd><p>A list of model results, one for each outcome variable. Each model result includes:</p><ul><li><p>ateAverage treatment effect</p></li>
<li><p>test_calibrationCalibration test results</p></li>
<li><p>custom_tableCustom evaluation table</p></li>
<li><p>tau_hatIndividual treatment effect estimates</p></li>
<li><p>rate_resultRank Average Treatment Effect (if compute_rate is TRUE)</p></li>
<li><p>dr_scoresDouble robust scores</p></li>
<li><p>policy_tree_depth_1Policy tree of depth 1</p></li>
<li><p>top_varsTop variables by importance</p></li>
<li><p>blp_topBest linear projection results for top variables</p></li>
<li><p>policy_tree_depth_2Policy tree of depth 2, trained on train_proportion of non-missing data</p></li>
<li><p>plot_dataData prepared for policy tree visualization, using the remaining proportion of non-missing data</p></li>
<li><p>qini_dataData frame containing Qini curve data for plotting</p></li>
</ul><p></p></dd>

  <dt>combined_table</dt>
<dd><p>A data frame combining all custom evaluation tables.</p></dd>

  <dt>outcome_vars</dt>
<dd><p>The character vector of outcome variable names that were modeled.</p></dd>

  <dt>not_missing</dt>
<dd><p>A vector of indices for complete cases.</p></dd>

  <dt>data</dt>
<dd><p>The input data (if save_data is TRUE).</p></dd>

  <dt>covariates</dt>
<dd><p>The input covariates (if save_data is TRUE).</p></dd>

  <dt>weights</dt>
<dd><p>The input weights (if save_data is TRUE).</p></dd>

  <dt>full_models</dt>
<dd><p>A list of full GRF model objects (if save_models is TRUE).</p></dd>

</dl></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/go-bayes" class="external-link">Joseph A Bulbulia</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

