<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Recompute QINI Curves Using AIPW Scores — margot_recompute_qini_aipw • margot</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Recompute QINI Curves Using AIPW Scores — margot_recompute_qini_aipw"><meta name="description" content="Recomputes QINI curves for binary treatment causal forest models using
Augmented Inverse Probability Weighted (AIPW) scores instead of IPW scores.
This provides more robust estimates, especially for observational data where
treatment assignment may be confounded."><meta property="og:description" content="Recomputes QINI curves for binary treatment causal forest models using
Augmented Inverse Probability Weighted (AIPW) scores instead of IPW scores.
This provides more robust estimates, especially for observational data where
treatment assignment may be confounded."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">margot</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.240</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/go-bayes/margot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Recompute QINI Curves Using AIPW Scores</h1>
      <small class="dont-index">Source: <a href="https://github.com/go-bayes/margot/blob/HEAD/R/margot_recompute_qini_aipw.R" class="external-link"><code>R/margot_recompute_qini_aipw.R</code></a></small>
      <div class="d-none name"><code>margot_recompute_qini_aipw.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Recomputes QINI curves for binary treatment causal forest models using
Augmented Inverse Probability Weighted (AIPW) scores instead of IPW scores.
This provides more robust estimates, especially for observational data where
treatment assignment may be confounded.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">margot_recompute_qini_aipw</span><span class="op">(</span></span>
<span>  <span class="va">margot_result</span>,</span>
<span>  model_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"regression_forest"</span>, <span class="st">"grf_scores"</span><span class="op">)</span>,</span>
<span>  n.trees <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  treatment_var <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-margot-result">margot_result<a class="anchor" aria-label="anchor" href="#arg-margot-result"></a></dt>
<dd><p>A list returned by <code><a href="margot_causal_forest.html">margot_causal_forest()</a></code> with
<code>save_models = TRUE</code> and <code>save_data = TRUE</code>.</p></dd>


<dt id="arg-model-name">model_name<a class="anchor" aria-label="anchor" href="#arg-model-name"></a></dt>
<dd><p>Character string specifying which model to recompute.
If NULL (default), all models will be recomputed.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string specifying the method to estimate mu.hat.
Options are "regression_forest" (default) or "grf_scores".</p></dd>


<dt id="arg-n-trees">n.trees<a class="anchor" aria-label="anchor" href="#arg-n-trees"></a></dt>
<dd><p>Number of trees to use for regression forests when
method = "regression_forest". Default is 2000.</p></dd>


<dt id="arg-treatment-var">treatment_var<a class="anchor" aria-label="anchor" href="#arg-treatment-var"></a></dt>
<dd><p>Character string specifying the treatment variable name.
If NULL, the function will try to detect it automatically.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, prints progress messages. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A modified version of the input margot_result with updated QINI
  curves based on AIPW scores. The structure remains compatible with all
  existing plotting and interpretation functions.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>AIPW scores provide double robustness: the estimator is consistent if either
the propensity score model OR the outcome model is correctly specified.
This is particularly valuable in observational studies.</p>
<p>The function supports two methods for estimating conditional means (mu.hat):</p><ul><li><p><strong>regression_forest</strong>: Trains separate regression forests on
    control and treated units to estimate E[Y|W=0,X] and E[Y|W=1,X].</p></li>
<li><p><strong>grf_scores</strong>: Uses the doubly robust scores from grf's
    internal computations (if available).</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Recompute QINI curves with AIPW for all models</span></span></span>
<span class="r-in"><span><span class="va">results_aipw</span> <span class="op">&lt;-</span> <span class="fu">margot_recompute_qini_aipw</span><span class="op">(</span><span class="va">margot_results</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Recompute for a specific model</span></span></span>
<span class="r-in"><span><span class="va">results_aipw</span> <span class="op">&lt;-</span> <span class="fu">margot_recompute_qini_aipw</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">margot_results</span>,</span></span>
<span class="r-in"><span>  model_name <span class="op">=</span> <span class="st">"model_anxiety"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use with plotting functions as normal</span></span></span>
<span class="r-in"><span><span class="fu"><a href="margot_plot_qini.html">margot_plot_qini</a></span><span class="op">(</span><span class="va">results_aipw</span>, <span class="st">"model_anxiety"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify treatment variable if auto-detection fails</span></span></span>
<span class="r-in"><span><span class="va">results_aipw</span> <span class="op">&lt;-</span> <span class="fu">margot_recompute_qini_aipw</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">margot_results</span>,</span></span>
<span class="r-in"><span>  treatment_var <span class="op">=</span> <span class="st">"t1_treatment"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/go-bayes" class="external-link">Joseph A Bulbulia</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

