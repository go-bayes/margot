<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>This function transforms longitudinal data from long format to wide format, ensuring that baseline measurements are correctly labeled and included. It handles multiple observations per subject across an indefinite number of waves, and allows for the specification of baseline variables, exposure variables, outcome variables, and time-varying confounders. — margot_wide_machine • margot</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Code-0.4.9/font.css" rel="stylesheet"><link href="../deps/Fira_Sans-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="This function transforms longitudinal data from long format to wide format, ensuring that baseline measurements are correctly labeled and included. It handles multiple observations per subject across an indefinite number of waves, and allows for the specification of baseline variables, exposure variables, outcome variables, and time-varying confounders. — margot_wide_machine"><meta name="description" content="This function transforms longitudinal data from long format to wide format,
ensuring that baseline measurements are correctly labeled and included.
It handles multiple observations per subject across an indefinite number of waves,
and allows for the specification of baseline variables, exposure variables,
outcome variables, and time-varying confounders."><meta property="og:description" content="This function transforms longitudinal data from long format to wide format,
ensuring that baseline measurements are correctly labeled and included.
It handles multiple observations per subject across an indefinite number of waves,
and allows for the specification of baseline variables, exposure variables,
outcome variables, and time-varying confounders."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">margot</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3.16</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/go-bayes/margot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>This function transforms longitudinal data from long format to wide format, ensuring that baseline measurements are correctly labeled and included. It handles multiple observations per subject across an indefinite number of waves, and allows for the specification of baseline variables, exposure variables, outcome variables, and time-varying confounders.</h1>
      <small class="dont-index">Source: <a href="https://github.com/go-bayes/margot/blob/HEAD/R/margot_wide_machine.R" class="external-link"><code>R/margot_wide_machine.R</code></a></small>
      <div class="d-none name"><code>margot_wide_machine.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function transforms longitudinal data from long format to wide format,
ensuring that baseline measurements are correctly labeled and included.
It handles multiple observations per subject across an indefinite number of waves,
and allows for the specification of baseline variables, exposure variables,
outcome variables, and time-varying confounders.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">margot_wide_machine</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  wave <span class="op">=</span> <span class="st">"wave"</span>,</span>
<span>  <span class="va">baseline_vars</span>,</span>
<span>  <span class="va">exposure_var</span>,</span>
<span>  <span class="va">outcome_vars</span>,</span>
<span>  confounder_vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  imputation_method <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>  include_exposure_var_baseline <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  include_outcome_vars_baseline <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A data frame containing the longitudinal data in long format.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>The name of the ID column identifying subjects (default is "id").</p></dd>


<dt id="arg-wave">wave<a class="anchor" aria-label="anchor" href="#arg-wave"></a></dt>
<dd><p>The name of the wave/time column (default is "wave").</p></dd>


<dt id="arg-baseline-vars">baseline_vars<a class="anchor" aria-label="anchor" href="#arg-baseline-vars"></a></dt>
<dd><p>A character vector of baseline variable names to be included at t0.</p></dd>


<dt id="arg-exposure-var">exposure_var<a class="anchor" aria-label="anchor" href="#arg-exposure-var"></a></dt>
<dd><p>A character string specifying the name of the exposure variable to be tracked across time.</p></dd>


<dt id="arg-outcome-vars">outcome_vars<a class="anchor" aria-label="anchor" href="#arg-outcome-vars"></a></dt>
<dd><p>A character vector of outcome variable names to be tracked across time.</p></dd>


<dt id="arg-confounder-vars">confounder_vars<a class="anchor" aria-label="anchor" href="#arg-confounder-vars"></a></dt>
<dd><p>An optional character vector of time-varying confounder variable names to be carried forward (default is NULL).</p></dd>


<dt id="arg-imputation-method">imputation_method<a class="anchor" aria-label="anchor" href="#arg-imputation-method"></a></dt>
<dd><p>A character string specifying the imputation method to use for baseline variables. Options are 'median' (default), 'mice', or 'none'.</p></dd>


<dt id="arg-include-exposure-var-baseline">include_exposure_var_baseline<a class="anchor" aria-label="anchor" href="#arg-include-exposure-var-baseline"></a></dt>
<dd><p>Logical indicating whether to include the exposure variable at baseline (t0).</p></dd>


<dt id="arg-include-outcome-vars-baseline">include_outcome_vars_baseline<a class="anchor" aria-label="anchor" href="#arg-include-outcome-vars-baseline"></a></dt>
<dd><p>Logical indicating whether to include outcome variables at baseline (t0).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A wide-format data frame with each subject's observations across time points
        represented in a single row. Baseline variables, exposure variables at baseline,
        and outcome variables at baseline (if included) have missing values imputed as specified.
        NA indicators are created for variables at baseline only if they have missing values.
        Exposure variables are tracked across waves but are not imputed beyond baseline.
        Outcome variables are included only at the final wave
        unless `include_outcome_vars_baseline` is `TRUE`. Confounders (if any) are carried forward using last observation carried forward (LOCF).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Key functionalities:
- **Imputation at Baseline**: Missing values are imputed at baseline (`t0`) for:
  - `baseline_vars`
  - `exposure_var` (if `include_exposure_var_baseline = TRUE`)
  - `outcome_vars` (if `include_outcome_vars_baseline = TRUE`)
  - 'median': For numeric variables, missing values are imputed with the median.
    For categorical variables, missing values are imputed with the mode.
  - 'mice': Multiple Imputation by Chained Equations is used.
    If MICE fails, the function falls back to median/mode imputation.
  - 'none': No imputation is performed.
- **NA Indicators**: NA indicator variables are created **only** for baseline variables
  that have missing values. Each such variable at baseline will have a corresponding
  NA indicator with the suffix `_na`.
- **Exposure Variables**: Tracked across waves but never imputed beyond baseline.
- **Outcome Variables**: Included only at the final wave unless `include_outcome_vars_baseline` is `TRUE`.
- **Confounder Variables**: If specified, these are carried forward across waves using LOCF.
- **Variable Inclusion per Wave**:
  - **Baseline (`t0`)**: Includes `baseline_vars`, exposure variables (if included), outcome variables (if included), and their NA indicators (only if necessary).
  - **Waves `t1` to `t(y_-2)`**: Include only the exposure variables (and confounders if specified).
  - **Final Wave (`t(y_-1)`)**: Includes only the outcome variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Define variables</span></span></span>
<span class="r-in"><span><span class="va">baseline_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"education"</span>, <span class="st">"income"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">exposure_var</span> <span class="op">&lt;-</span> <span class="st">"treatment"</span></span></span>
<span class="r-in"><span><span class="va">outcome_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"health_score"</span>, <span class="st">"quality_of_life"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">confounder_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stress_level"</span>, <span class="st">"exercise_frequency"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Transform data to wide format with baseline imputation</span></span></span>
<span class="r-in"><span><span class="va">df_wide_impute</span> <span class="op">&lt;-</span> <span class="fu">margot_wide_machine</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data_long</span>,</span></span>
<span class="r-in"><span>  id <span class="op">=</span> <span class="st">"patient_id"</span>,</span></span>
<span class="r-in"><span>  wave <span class="op">=</span> <span class="st">"visit_time"</span>,</span></span>
<span class="r-in"><span>  baseline_vars <span class="op">=</span> <span class="va">baseline_vars</span>,</span></span>
<span class="r-in"><span>  exposure_var <span class="op">=</span> <span class="va">exposure_var</span>,</span></span>
<span class="r-in"><span>  outcome_vars <span class="op">=</span> <span class="va">outcome_vars</span>,</span></span>
<span class="r-in"><span>  confounder_vars <span class="op">=</span> <span class="va">confounder_vars</span>,</span></span>
<span class="r-in"><span>  imputation_method <span class="op">=</span> <span class="st">"mice"</span>,</span></span>
<span class="r-in"><span>  include_exposure_var_baseline <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  include_outcome_vars_baseline <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Starting data transformation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Pre-processing data...</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'data_long' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/go-bayes" class="external-link">Joseph A Bulbulia</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

