<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Recompute Average Treatment Effects with Different Target Samples — margot_recompute_ate • margot</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Code-0.4.10/font.css" rel="stylesheet"><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Recompute Average Treatment Effects with Different Target Samples — margot_recompute_ate"><meta name="description" content="This function allows recomputation of average treatment effects (ATEs) from fitted
causal forest models using different target samples or estimation methods without
refitting the models. This is useful for sensitivity analysis and exploring
treatment effects in different subpopulations."><meta property="og:description" content="This function allows recomputation of average treatment effects (ATEs) from fitted
causal forest models using different target samples or estimation methods without
refitting the models. This is useful for sensitivity analysis and exploring
treatment effects in different subpopulations."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">margot</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.245</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/go-bayes/margot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Recompute Average Treatment Effects with Different Target Samples</h1>
      <small class="dont-index">Source: <a href="https://github.com/go-bayes/margot/blob/HEAD/R/margot_recompute_ate.R" class="external-link"><code>R/margot_recompute_ate.R</code></a></small>
      <div class="d-none name"><code>margot_recompute_ate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows recomputation of average treatment effects (ATEs) from fitted
causal forest models using different target samples or estimation methods without
refitting the models. This is useful for sensitivity analysis and exploring
treatment effects in different subpopulations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">margot_recompute_ate</span><span class="op">(</span></span>
<span>  <span class="va">causal_forest_output</span>,</span>
<span>  target_sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"treated"</span>, <span class="st">"control"</span>, <span class="st">"overlap"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"AIPW"</span>,</span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RD"</span>, <span class="st">"RR"</span><span class="op">)</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  respect_train_test_split <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-causal-forest-output">causal_forest_output<a class="anchor" aria-label="anchor" href="#arg-causal-forest-output"></a></dt>
<dd><p>Output from `margot_causal_forest()` or
`margot_causal_forest_parallel()`. Must have been run with `save_models = TRUE`.</p></dd>


<dt id="arg-target-sample">target_sample<a class="anchor" aria-label="anchor" href="#arg-target-sample"></a></dt>
<dd><p>Character string specifying the target sample for ATE estimation.
Options are:</p><ul><li><p>"all" - All units (default in original models)</p></li>
<li><p>"treated" - Only treated units (ATT)</p></li>
<li><p>"control" - Only control units (ATC)</p></li>
<li><p>"overlap" - Units with propensity scores away from 0 and 1</p></li>
</ul></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string specifying the estimation method. Currently only
"AIPW" (Augmented Inverse Probability Weighting) is supported by grf.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Character string specifying the scale of the estimate. Either "RD"
(risk difference) or "RR" (risk ratio). Default is "RD".</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>The hypothesized increase in outcome for RD scale E-value calculations.
Default is 1.</p></dd>


<dt id="arg-sd">sd<a class="anchor" aria-label="anchor" href="#arg-sd"></a></dt>
<dd><p>The standard deviation of the outcome for RD scale E-value calculations.
Default is 1.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>Optional logical vector for subsetting the data. Default is NULL.</p></dd>


<dt id="arg-respect-train-test-split">respect_train_test_split<a class="anchor" aria-label="anchor" href="#arg-respect-train-test-split"></a></dt>
<dd><p>Logical. If TRUE and the original analysis used
use_train_test_split=TRUE, computes treatment effects on the test set only for
consistency with policy evaluation. Default is TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with the same structure as the original causal forest output, but with:</p><ul><li><p>Updated `ate` values in each model's results</p></li>
<li><p>Recomputed `custom_table` with new E-values and renamed effect columns (ATE/ATT/ATC/ATO)</p></li>
<li><p>Updated `combined_table` with all new estimates</p></li>
<li><p>A new element `ate_params` documenting the parameters used</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function requires that the original causal forest models were saved
(using `save_models = TRUE`). It extracts the fitted models and recomputes
ATEs using the specified target sample.</p>
<p>The different target samples represent different estimands:
- "all": Average Treatment Effect (ATE) for the entire population
- "treated": Average Treatment Effect on the Treated (ATT)
- "control": Average Treatment Effect on the Control (ATC)
- "overlap": ATE for units with good overlap in propensity scores</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># First fit causal forest models with saved models</span></span></span>
<span class="r-in"><span><span class="va">cf_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="margot_causal_forest.html">margot_causal_forest</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">mydata</span>,</span></span>
<span class="r-in"><span>  outcome_vars <span class="op">=</span> <span class="va">outcomes</span>,</span></span>
<span class="r-in"><span>  covariates <span class="op">=</span> <span class="va">X</span>,</span></span>
<span class="r-in"><span>  save_models <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Later, get ATEs for different target populations</span></span></span>
<span class="r-in"><span><span class="va">ate_overlap</span> <span class="op">&lt;-</span> <span class="fu">margot_recompute_ate</span><span class="op">(</span><span class="va">cf_results</span>, target_sample <span class="op">=</span> <span class="st">"overlap"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ate_treated</span> <span class="op">&lt;-</span> <span class="fu">margot_recompute_ate</span><span class="op">(</span><span class="va">cf_results</span>, target_sample <span class="op">=</span> <span class="st">"treated"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare estimates</span></span></span>
<span class="r-in"><span><span class="va">cf_results</span><span class="op">$</span><span class="va">combined_table</span> <span class="co"># Original (all units)</span></span></span>
<span class="r-in"><span><span class="va">ate_overlap</span><span class="op">$</span><span class="va">combined_table</span> <span class="co"># Overlap units only</span></span></span>
<span class="r-in"><span><span class="va">ate_treated</span><span class="op">$</span><span class="va">combined_table</span> <span class="co"># Treated units only</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/go-bayes" class="external-link">Joseph A Bulbulia</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

