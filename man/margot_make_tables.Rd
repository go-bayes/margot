% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/margot_make_tables.R
\name{margot_make_tables}
\alias{margot_make_tables}
\title{Create Summary Tables Using table1 with Custom Formatting}
\usage{
margot_make_tables(
  data,
  vars,
  by,
  labels = NULL,
  factor_vars = NULL,
  ordinal_vars = NULL,
  ordinal_levels = list(),
  binary_to_yesno = FALSE,
  binary_labels = c("No", "Yes"),
  auto_integer_ordinals = FALSE,
  integer_ordinal_range = 0:10,
  table1_opts = list(),
  format = c("markdown", "latex", "flextable"),
  kable_opts = list(),
  flex_opts = list(),
  quarto_label = NULL
)
}
\arguments{
\item{data}{A \code{data.frame} containing the dataset.}

\item{vars}{A character vector of variable names to include on the left-hand side of the table.}

\item{by}{A character vector of variable names to stratify the table by. Supports multiple variables for interactions.}

\item{labels}{A named character vector for custom variable labels. Names should correspond to variable names in \code{vars}.}

\item{factor_vars}{An optional character vector of variable names in \code{vars} to convert to factors for frequency tables.}

\item{ordinal_vars}{An optional character vector of variable names in \code{vars} to convert to ordered factors for ordinal frequency displays.}

\item{ordinal_levels}{An optional named list that specifies custom level orderings/labels for ordinal variables. Each entry can be either a vector of desired levels, a named vector where names identify the raw values, or a list with \code{levels} and optional \code{labels} components.}

\item{binary_to_yesno}{Logical toggle; when \code{TRUE}, numeric 0/1 indicators in \code{vars} are converted to factors that show frequencies.}

\item{binary_labels}{Character vector of length two that labels binary indicators when \code{binary_to_yesno = TRUE}. Defaults to \code{c("No", "Yes")}.}

\item{auto_integer_ordinals}{Logical toggle; when \code{TRUE}, numeric variables whose unique values fall inside \code{integer_ordinal_range} are treated as ordered factors in the table output.}

\item{integer_ordinal_range}{Integer vector that defines the permissible values for automatic ordinal detection (default: \code{0:10}).}

\item{table1_opts}{A list of additional options to pass to \code{table1::table1()}. For example, \code{list(overall = FALSE, transpose = TRUE)}.}

\item{format}{A character string specifying the output format. Options are \code{"markdown"} (default), \code{"latex"}, or \code{"flextable"}.}

\item{kable_opts}{A list of additional options controlling table styling:
\itemize{
  \item For \code{format = "latex"}, these are passed to \code{kableExtra::kable_styling()}.
  \item For \code{format = "markdown"}, currently only for documentation purposes.
}}

\item{flex_opts}{A list of additional options for flextable formatting:
\itemize{
  \item \code{font_size}: Font size for the table (default: 9)
  \item \code{font_size_header}: Font size for headers (default: 10)
  \item \code{theme}: Theme function to apply (default: "theme_vanilla")
  \item \code{autofit}: Whether to autofit columns (default: TRUE)
  \item \code{width}: Table width (0-1 for proportion of page width, default: 1)
}}

\item{quarto_label}{An optional label for Quarto cross-references (e.g., "tbl-demographics"). When specified for LaTeX output,
this adds a \code{\\label{}} command to enable Quarto's cross-referencing system.}
}
\value{
A table object formatted for the specified output:
 \itemize{
   \item For \code{format = "latex"}, a kableExtra-formatted LaTeX table with optional Quarto label
   \item For \code{format = "markdown"}, a markdown-formatted kable table with bold variable names
   \item For \code{format = "flextable"}, a flextable object optimized for Word output
 }
}
\description{
\code{margot_make_tables} is a wrapper for \code{table1::table1()} which simplifies the creation of summary tables.
It provides custom variable labelling, formatting, factor conversion, and additional table options.
This function is optimized for \code{"markdown"}, \code{"latex"}, and \code{"flextable"} outputs, with special support for Quarto documents.
}
\details{
Ordinal/binary controls:
\itemize{
  \item \code{binary_to_yesno} detects numeric/logical 0/1 columns in \code{vars} and converts them
    to two-level factors (defaults to \code{"No"/"Yes"} labels via \code{binary_labels}).
  \item Explicit ordinal variables can be supplied via \code{ordinal_vars}; these are coerced to ordered factors before table construction.
  \item Use \code{ordinal_levels} (a named list) to specify per-variable level order and, optionally, display labels.
    Each entry can be a simple vector of desired levels, a named vector (names = raw values, values = labels),
    or a list with \code{levels}/\code{labels}.
  \item When \code{auto_integer_ordinals = TRUE}, any numeric variable whose unique values fall fully inside
    \code{integer_ordinal_range} (default \code{0:10}) is automatically treated as ordered, unless it was already converted.
    This is useful for Likert-style items stored as integers.
}
}
\examples{
\dontrun{
# Flextable output for Word
flex_table <- margot_make_tables(
  data = mydata,
  vars = c("age", "gender", "income"),
  by = "group",
  labels = c("age" = "Age", "gender" = "Gender", "income" = "Income"),
  factor_vars = "gender",
  table1_opts = list(overall = FALSE, transpose = TRUE),
  format = "flextable",
  flex_opts = list(font_size = 8)
)
}

}
