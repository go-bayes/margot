% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/margot_transition_table.R
\name{margot_transition_table}
\alias{margot_transition_table}
\title{Format a Transition Table with observed‑indicator filtering}
\usage{
margot_transition_table(
  data,
  state_var,
  id_var,
  wave_var,
  waves = NULL,
  state_names = NULL,
  observed_var = NULL,
  observed_val = 1,
  table_name = "transition_table"
)
}
\arguments{
\item{data}{a data frame containing your id, state, wave, and (optionally) an observed indicator.}

\item{state_var}{name of the column indicating the state at each wave.}

\item{id_var}{name of the column identifying each participant.}

\item{wave_var}{name of the column indicating the wave (numeric or factor).}

\item{waves}{optional numeric vector of waves to include (defaults to all present in data).}

\item{state_names}{optional character vector of labels for each state.}

\item{observed_var}{optional name of a column marking participants still observed.}

\item{observed_val}{value in \code{observed_var} that denotes “observed” (default 1).}

\item{table_name}{name for the output object (default "transition_table").}
}
\value{
an object of class \code{margot_transitions} with
  \code{tables} (markdown-formatted matrices), paired \code{tables_data}
  (the underlying numeric data frames), \code{explanation}, \code{wave_info},
  and a \code{quarto_code} helper. The returned object also includes
  convenience functions \code{$get_table_data()} and
  \code{$compute_ipsi_probabilities()} to retrieve the raw counts or to run
  \code{margot_compute_ipsi_probability()} directly from each table.
}
\description{
Reshapes a long‑format transition frequency data frame into a
wide‑format table with totals, and formats it using markdown.
Diagonal elements are bolded to highlight state stability.
}
\examples{
dt <- data.frame(
  id = rep(1:3, each = 3),
  wave = rep(c(2018, 2019, 2022), times = 3),
  religion_church_binary = c(0, 0, 1,
                             0, 1, 1,
                             1, 1, 1),
  year_measured = 1
)

transitions <- margot_transition_table(
  dt,
  state_var = "religion_church_binary",
  id_var = "id",
  wave_var = "wave",
  observed_var = "year_measured",
  observed_val = 1,
  waves = c(2018, 2019, 2022)
)

# Extract machine-readable counts for the first transition
transitions$get_table_data(which = 1)

# Compute IPSI counterfactual initiation probabilities for the first transition
ipsi_wave1 <- transitions$compute_ipsi_probabilities(which = 1)
ipsi_wave1$probabilities
}
