% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/margot_interpret_heterogeneity.R
\name{margot_interpret_heterogeneity}
\alias{margot_interpret_heterogeneity}
\title{Interpret Heterogeneity Evidence from Multiple Sources}
\usage{
margot_interpret_heterogeneity(
  models = NULL,
  spend_levels = c(0.1, 0.4),
  require_any_positive = TRUE,
  exclude_negative_any = TRUE,
  require_omnibus = FALSE,
  alpha = 0.05,
  adjust = "BH",
  flipped_outcomes = NULL,
  label_mapping = NULL,
  verbose = TRUE,
  include_extended_report = FALSE,
  rate_results = NULL,
  qini_results = NULL,
  omnibus_results = NULL
)
}
\arguments{
\item{models}{Output from `margot_causal_forest()` containing model results}

\item{spend_levels}{Numeric vector of spend levels for QINI analysis. 
Default is c(0.1, 0.4).}

\item{require_any_positive}{Logical. If TRUE (default), include models that 
show positive evidence in ANY method. If FALSE, require positive evidence 
in ALL methods.}

\item{exclude_negative_any}{Logical. If TRUE (default), exclude models that 
show negative evidence in ANY method. If FALSE, only exclude if negative 
in ALL methods.}

\item{require_omnibus}{Logical. If TRUE, only include models that pass the 
omnibus calibration test. Default is FALSE.}

\item{alpha}{Numeric. Significance level for RATE tests. Default is 0.05.
Note: this controls which RATE estimates are considered significant after
multiple testing correction.}

\item{adjust}{Character. Multiple testing adjustment method for RATE estimates. 
Options include "BH" (Benjamini-Hochberg), "BY" (Benjamini-Yekutieli), 
"bonferroni", "holm", "fdr", or "none". Default is "BH".}

\item{flipped_outcomes}{Character vector of outcome names that were flipped 
(reversed) in preprocessing. Used for interpretation text.}

\item{label_mapping}{Named list for mapping model names to human-readable labels.}

\item{verbose}{Logical. If TRUE, show progress messages. Default is TRUE.}

\item{include_extended_report}{Logical. If TRUE, generate detailed academic-style report
with full statistics and confidence intervals. Default is FALSE.}

\item{rate_results}{Optional pre-computed RATE results to skip computation.}

\item{qini_results}{Optional pre-computed QINI results to skip computation.}

\item{omnibus_results}{Optional pre-computed omnibus test results to skip computation.}
}
\value{
A list containing:
  \item{selected_model_ids}{Character vector of model IDs with heterogeneity evidence}
  \item{selected_model_names}{Character vector of human-readable model names}
  \item{cautiously_selected_model_ids}{Character vector of model IDs with mixed evidence (positive in some tests but negative in others)}
  \item{cautiously_selected_model_names}{Character vector of human-readable model names with mixed evidence}
  \item{all_selected_model_ids}{Combined vector of selected_model_ids and cautiously_selected_model_ids}
  \item{all_selected_model_names}{Combined vector of selected_model_names and cautiously_selected_model_names}
  \item{excluded_model_ids}{Character vector of model IDs to exclude}
  \item{excluded_model_names}{Character vector of human-readable excluded model names}
  \item{evidence_summary}{Data frame with detailed evidence by source including evidence_type categorization. Contains columns: model_id, model_name, mean_prediction_test (calibration status), differential_prediction_test (heterogeneity test), rate_autoc, rate_qini, qini_curve, positive_count, negative_count, and evidence_type. Note: mean_prediction_test indicates calibration quality but is not included in heterogeneity scoring}
  \item{interpretation}{Character string with main interpretation text organized by evidence categories}
  \item{summary}{Character string with brief summary}
  \item{recommendations}{Character string with actionable recommendations}
  \item{rate_results}{List containing AUTOC and QINI RATE results}
  \item{qini_results}{QINI curve interpretation results}
  \item{omnibus_results}{Omnibus calibration test results}
  \item{concordance}{List analyzing agreement between methods}
  \item{extended_report}{Character string with detailed academic report (if include_extended_report = TRUE)}
}
\description{
Combines evidence from multiple heterogeneity tests (RATE AUTOC, RATE QINI, 
QINI curves, and omnibus calibration tests) to provide unified recommendations 
about which models show treatment effect heterogeneity.
}
\examples{
\dontrun{
# Simple usage - let the function handle everything
het_evidence <- margot_interpret_heterogeneity(
  models = causal_forest_results,
  spend_levels = c(0.1, 0.4),
  flipped_outcomes = c("anxiety", "depression")
)

# View interpretation
cat(het_evidence$interpretation)

# Use selected models for targeting
policy_results <- margot_policy(
  causal_forest_results,
  model_names = het_evidence$selected_model_ids
)

# Advanced usage with pre-computed results
het_evidence <- margot_interpret_heterogeneity(
  models = causal_forest_results,
  rate_results = my_rate_results,
  require_omnibus = TRUE
)
}

}
