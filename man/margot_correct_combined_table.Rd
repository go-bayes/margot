% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/margot_correct_combined_table.R,
%   R/margot_plot.R
\name{margot_correct_combined_table}
\alias{margot_correct_combined_table}
\title{Correct a "combined table" for multiplicity **and** recompute *E*-values}
\usage{
margot_correct_combined_table(
  combined_table,
  adjust = c("bonferroni", "none"),
  alpha = 0.05,
  scale = c("RD", "RR"),
  delta = 1,
  sd = 1
)

margot_correct_combined_table(
  combined_table,
  adjust = c("bonferroni", "none"),
  alpha = 0.05,
  scale = c("RD", "RR"),
  delta = 1,
  sd = 1
)
}
\arguments{
\item{combined_table}{A data frame with *at least* the columns
\itemize{
  \item `E[Y(1)]-E[Y(0)]` **or** `E[Y(1)]/E[Y(0)]`
  \item `2.5 %`, `97.5 %`   (unadjusted CI limits)
}
Extra columns (e.g. the original *E*-values) are carried through.}

\item{adjust}{multiplicity correction method: "none", "bonferroni"
Bonferroni provides conservative family-wise error rate control.}

\item{alpha}{Family-wise error-rate for bonferroni. Default `0.05`.}

\item{scale}{Scale to use when recomputing the *E*-value.
`"RD"` (risk difference / ATE, **default**) or `"RR"` (risk ratio).}

\item{delta, sd}{Arguments passed to [EValue::evalues.OLS()] when
`scale = "RD"`.  Ignored for `"RR"`.}
}
\value{
A data frame with the same rows (and order) as `combined_table`, but
  with
  \itemize{
    \item updated `2.5 %` and `97.5 %` columns, and
    \item freshly computed `E_Value` and `E_Val_bound`.
  }

A data frame with the same rows (and order) as `combined_table`, but
  with
  \itemize{
    \item updated `2.5 %` and `97.5 %` columns, and
    \item freshly computed `E_Value` and `E_Val_bound`.
  }
}
\description{
`margot_correct_combined_table()` takes the **combined_table** produced by the
various *margot* models (or by your own code) and
\enumerate{
  \item widens the confidence interval according to the chosen
        family–wise-error correction, **and**
  \item recalculates *E*-values (and their lower bounds) so they match the
        new interval.
}
By default it implements the single–step **Bonferroni** correction at
\eqn{\alpha = 0.05} as advocated by VanderWeele & Mathur (2019).

`margot_correct_combined_table()` takes the **combined_table** produced by the
various *margot* models (or by your own code) and
\enumerate{
  \item widens the confidence interval according to the chosen
        family–wise-error correction, **and**
  \item recalculates *E*-values (and their lower bounds) so they match the
        new interval.
}
By default it implements the single–step **Bonferroni** correction at
\eqn{\alpha = 0.05} as advocated by VanderWeele & Mathur (2019).
}
\section{How the correction is applied}{

Let \eqn{m} be the number of rows (tests).
\itemize{
  \item **Bonferroni** uses
    \deqn{ z^* = \Phi^{-1}\!\bigl(1-\alpha/(2m)\bigr) }
    and rescales the original half-width.
  \item **Holm** first step-down adjusts the (two-sided) *p*-value for each
    test, then back-calculates a *symmetric* CI whose coverage matches the
    adjusted *p*.  Point estimates **never** change.
  \item **BH** (Benjamini-Hochberg) applies FDR correction to *p*-values,
    then back-calculates symmetric CIs. Controls false discovery rate rather
    than family-wise error rate.
}


Let \eqn{m} be the number of rows (tests).
\itemize{
  \item **Bonferroni** uses
    \deqn{ z^* = \Phi^{-1}\!\bigl(1-\alpha/(2m)\bigr) }
    and rescales the original half-width.
  \item **none** applies no correction, keeping the original confidence intervals.
}
}

\references{
VanderWeele TJ, Mathur MB (2019).
*Some desirable properties of the Bonferroni correction:
Is the Bonferroni correction really so bad?*
**Am J Epidemiol** 188(3): 617–618.

VanderWeele TJ, Mathur MB (2019).
*Some desirable properties of the Bonferroni correction:
Is the Bonferroni correction really so bad?*
**Am J Epidemiol** 188(3): 617–618.
}
