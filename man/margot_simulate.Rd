% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/margot_simulate.R
\name{margot_simulate}
\alias{margot_simulate}
\title{Simulate Longitudinal Panel Data for Causal Inference}
\usage{
margot_simulate(
  n = 500,
  waves = 3,
  p_covars = 1,
  censoring = list(rate = 0.2, exposure_dependence = FALSE, latent_dependence = FALSE,
    latent_rho = 0.5),
  item_missing_rate = 0,
  positivity = c("good", "edge", "violated"),
  exposure_outcome = 0.6,
  covar_feedback = 0,
  y_feedback = 0,
  outcome_type = c("binary", "continuous"),
  wide = FALSE,
  seed = NULL
)
}
\arguments{
\item{n}{Integer. Number of individuals (default: 500).}

\item{waves}{Integer. Number of measurement waves (1-20, default: 3).}

\item{p_covars}{Integer. Number of time-varying covariates (default: 1).}

\item{censoring}{List with components:
\describe{
  \item{rate}{Baseline censoring rate (default: 0.2)}
  \item{exposure_dependence}{Logical. Does censoring depend on prior exposure? (default: FALSE)}
  \item{latent_dependence}{Logical. Does censoring depend on latent factor? (default: FALSE)}
  \item{latent_rho}{Correlation with latent factor if latent_dependence = TRUE (default: 0.5)}
}}

\item{item_missing_rate}{Numeric. MCAR rate for covariates (0-1, default: 0).}

\item{positivity}{Character. Positivity assumption scenario:
\describe{
  \item{"good"}{Well-behaved propensity scores}
  \item{"edge"}{Near-violation of positivity}
  \item{"violated"}{Deterministic treatment assignment}
}}

\item{exposure_outcome}{Numeric. Effect of treatment on outcome (default: 0.6).}

\item{covar_feedback}{Numeric. Effect of treatment on future covariates (default: 0).}

\item{y_feedback}{Numeric. Effect of previous outcome on next treatment (default: 0).}

\item{outcome_type}{Character. Type of outcome variable ("binary" or "continuous").}

\item{wide}{Logical. Return wide format if TRUE, long format if FALSE (default: FALSE).}

\item{seed}{Integer. Random seed for reproducibility (default: NULL).}
}
\value{
A tibble with simulated data. Format depends on \code{wide} parameter:
  \describe{
    \item{Wide format}{Columns: id, t0_l*, t0_y, t0_a, t1_l*, t1_y, t1_a, ..., y}
    \item{Long format}{Columns: id, wave, l1...lp, y, a, y_end}
  }
  
  In long format, \code{y_end} contains the final outcome (non-NA only at the 
  last observed wave for each individual).
}
\description{
Generates synthetic longitudinal panel data with flexible options for treatment
assignment, outcome generation, censoring, and missing data patterns. Useful for
testing causal inference methods and teaching.
}
\details{
The simulation generates:
\itemize{
  \item A latent baseline factor \code{u} affecting treatment and outcomes
  \item Time-varying covariates with optional AR(1) structure
  \item Treatment assignment based on covariates and latent factor
  \item Outcomes influenced by treatment, covariates, and latent factor
  \item Censoring patterns (MCAR or dependent on covariates/treatment)
}
}
\examples{
# basic simulation with default settings
dat <- margot_simulate(n = 200, waves = 3, seed = 123)

# simulate with treatment feedback and edge positivity
dat_complex <- margot_simulate(
  n = 500, 
  waves = 4,
  p_covars = 2,
  positivity = "edge",
  y_feedback = 0.5,
  covar_feedback = 0.3,
  wide = TRUE,
  seed = 2025
)

# simulate with censoring dependent on treatment
dat_censor <- margot_simulate(
  n = 300,
  waves = 5,
  censoring = list(
    rate = 0.3,
    exposure_dependence = TRUE,
    latent_dependence = TRUE,
    latent_rho = 0.7
  ),
  seed = 999
)

}
