% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/margot_compute_ipsi_probability.R
\name{margot_compute_ipsi_probability}
\alias{margot_compute_ipsi_probability}
\title{Compute IPSI counterfactual initiation probabilities}
\usage{
margot_compute_ipsi_probability(trans_matrix, deltas = c(2, 5, 10))
}
\arguments{
\item{trans_matrix}{A data frame containing at least a `"From / To"` column,
a `"State 1"` column, and a `"Total"` column. Must include a row identified
as `"State 0"` under `"From / To"`, representing non-attenders at the prior
wave. You can pass either the raw data frame or the `knitr_kable` object
returned inside `margot_transition_table(... )$tables[[i]]` (the function
automatically reads the attached `table_data` attribute).}

\item{deltas}{Numeric vector of IPSI shift magnitudes (greater than 1). The
defaults match the standard IPSI reporting set `c(2, 5, 10)`.}
}
\value{
A data frame with one row per delta containing the natural initiation
  probability `p`, its exact 95% Clopper-Pearson confidence limits, the
  counterfactual probability `p' = 1 - (1 - p) / delta`, and the fold increase
  `p'/p`. The result carries a `counts` attribute with the raw initiation and
  at-risk totals and the natural-probability interval used to compute `p`.
}
\description{
Takes a formatted transition matrix (for example, one of the formatted tables
produced by `margot_transition_table()` such as
`transition_tables$tables_data[[i]]` or the paired `knitr_kable` stored under
`transition_tables$tables[[i]]`) and computes the natural initiation
probability for baseline non-attenders along with the counterfactual
probabilities implied by marginal incremental propensity score interventions
(IPSIs) for a set of proposed deltas.
}
\examples{
trans <- data.frame(
  `From / To` = c("State 0", "State 1"),
  `State 0` = c(27380, 330),
  `State 1` = c(845, 170),
  Total = c(28225, 500),
  check.names = FALSE
)
margot_compute_ipsi_probability(trans)
margot_compute_ipsi_probability(trans, deltas = c(1.5, 3))

}
